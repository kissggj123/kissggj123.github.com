<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ° Bunny CC's Archive v7.0.6 - ğŸ“œ The Bard's Rabbit</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Keep Press Start 2P for pixelated titles, Noto Sans SC for main content -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for TRON Theming (Dynamic colors via JS) */
        :root {
            --glow-rgb: 34, 211, 238; /* Cyan - Default */
            --glow-light-rgb: 103, 232, 249; /* Cyan Light - Default */
            --bg-color: #010409; /* Deep Dark Blue - Default Base Background */
            --surface-color: rgba(var(--glow-rgb), 0.08);
            --grid-color: rgba(var(--glow-rgb), 0.15);
            --text-color: #e6edf3;
            --text-muted-color: #8b949e;
            --bg-radial-start: rgba(var(--glow-rgb), 0.08);
            --bg-radial-end: rgba(1, 4, 9, 0.9);
            --grad-pos-x: 20%;
            --grad-pos-y: 20%;
        }

        /* Base styles */
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.5s ease, color 0.5s ease;
            overflow-x: hidden;
            overflow-y: auto;
            opacity: 0;
            animation: fadeIn 1s ease 0.5s forwards;
            position: relative;
        }
        
        .font-pixel { font-family: 'Press Start 2P', cursive; }
        .glow-text { color: rgb(var(--glow-light-rgb)); text-shadow: 0 0 8px rgba(var(--glow-rgb), 0.8); }
        .glow-border { 
            border: 1px solid rgba(var(--glow-rgb), 0.4); 
            box-shadow: 0 0 12px rgba(var(--glow-rgb), 0.2), inset 0 0 8px rgba(var(--glow-rgb), 0.15); 
            transition: border-color 0.5s ease, box-shadow 0.5s ease;
        }
        
        #grid-background {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2;
            background-image:
                radial-gradient(circle at var(--grad-pos-x) var(--grad-pos-y), 
                                var(--bg-radial-start) 0%, 
                                var(--bg-radial-end) 60%),
                linear-gradient(rgba(var(--glow-rgb), 0.15) 1px, transparent 1px),
                linear-gradient(90deg, rgba(var(--glow-rgb), 0.15) 1px, transparent 1px);
            background-size: cover, 50px 50px, 50px 50px;
            background-repeat: no-repeat, repeat, repeat;
            animation: pan-grid 20s linear infinite, radial-move 60s ease-in-out infinite alternate;
            transition: background-image 0.5s ease;
        }

        #scanline-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100;
            pointer-events: none;
            background: linear-gradient(to bottom, rgba(18, 18, 18, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(to bottom, rgba(255, 255, 255, 0.08), rgba(0, 0, 0, 0.08));
            background-size: 100% 4px, 100% 1px;
            animation: scanline-move 10s linear infinite;
        }

        .pacman-container {
            position: relative; width: 160px; height: 160px; border-radius: 50%; 
            overflow: hidden; transition: box-shadow 0.3s ease;
        }
        .pacman-container .profile-image-wrapper {
            width: 100%; height: 100%; border-radius: 50%; overflow: hidden; 
            position: relative; transition: clip-path 0.4s ease-in-out;
            clip-path: circle(50% at 50% 50%);
        }
        .pacman-container:hover .profile-image-wrapper {
            clip-path: polygon(0% 0%, 100% 0%, 100% 40%, 50% 50%, 100% 60%, 100% 100%, 0% 100%);
        }
        .pacman-container:hover {
            box-shadow: 0 0 30px rgba(var(--glow-rgb), 0.9), inset 0 0 20px rgba(var(--glow-rgb), 0.6);
        }

        .main-container {
            background-color: var(--surface-color);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            min-height: 80vh; min-width: 320px; position: relative;
            transition: background-color 0.5s ease;
        }
        .ui-module { 
            opacity: 0; transform: translateY(20px); 
            animation: module-boot 0.5s ease forwards; 
            min-height: 150px; background-color: rgba(var(--glow-rgb), 0.05);
            border-left: 3px solid rgba(var(--glow-rgb), 0.5);
            transition: background-color 0.5s ease, border-left-color 0.5s ease;
        }
        .list-pellet li::before {
            content: 'â€¢'; color: rgb(var(--glow-light-rgb)); font-weight: bold;
            display: inline-block; width: 1em; margin-left: -1em;
            animation: pellet-glow 1.5s infinite alternate;
        }

        .modal-overlay { background-color: rgba(0,0,0,0.7); backdrop-filter: blur(4px); z-index: 1000; }
        .modal-content-base { background-color: var(--surface-color); transition: background-color 0.5s ease; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pan-grid { from { background-position: 0 0; } to { background-position: -50px -50px; } }
        @keyframes scanline-move { from { background-position: 0 0; } to { background-position: 0 100%; } }
        @keyframes pellet-glow { from { text-shadow: 0 0 2px; } to { text-shadow: 0 0 10px rgba(var(--glow-light-rgb), 1); } }
        @keyframes module-boot { to { opacity: 1; transform: translateY(0); } }
        @keyframes radial-move {
            0%   { --grad-pos-x: 15%; --grad-pos-y: 20%; }
            12%  { --grad-pos-x: 80%; --grad-pos-y: 10%; }
            25%  { --grad-pos-x: 90%; --grad-pos-y: 90%; }
            37%  { --grad-pos-x: 50%; --grad-pos-y: 75%; }
            50%  { --grad-pos-x: 10%; --grad-pos-y: 85%; }
            62%  { --grad-pos-x: 20%; --grad-pos-y: 40%; }
            75%  { --grad-pos-x: 85%; --grad-pos-y: 55%; }
            87%  { --grad-pos-x: 45%; --grad-pos-y: 5%; }
            100% { --grad-pos-x: 15%; --grad-pos-y: 20%; }
        }

        .record-scrollbar::-webkit-scrollbar { width: 8px; }
        .record-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .record-scrollbar::-webkit-scrollbar-thumb { background: rgba(var(--glow-rgb), 0.5); border-radius: 4px; }
        .record-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(var(--glow-rgb), 0.8); }

        #wandering-rabbit {
            position: fixed; width: 72px; height: 72px; z-index: 90; 
            pointer-events: none; fill: rgb(var(--glow-light-rgb)); 
            filter: drop-shadow(0 0 15px rgba(var(--glow-rgb), 0.8));
            will-change: transform;
        }
        .rabbit-dropping {
            position: absolute; width: 6px; height: 6px;
            background-color: #4a2c2a; border-radius: 1px; 
            transform: scale(1); opacity: 1;
            transition: transform 2s ease-out, opacity 2s ease-out; 
            z-index: 89; pointer-events: none; 
            box-shadow: 0 0 2px rgba(0,0,0,0.5); 
            will-change: transform, opacity;
        }
        .rabbit-dropping.fade-out { transform: scale(0.2); opacity: 0; }

        .flex.items-center.justify-center.min-h-screen.p-4 {
            align-items: flex-start; padding-top: 2rem; padding-bottom: 2rem;
        }
        
        .changelog-entry {
            padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;
            background-color: rgba(var(--glow-rgb), 0.1);
            border: 1px solid rgba(var(--glow-rgb), 0.4);
            box-shadow: 0 2px 8px rgba(var(--glow-rgb), 0.1);
            transition: all 0.3s ease;
        }
        .changelog-entry ul { list-style: none; padding-left: 1.5em; }
        .changelog-entry li::before {
            content: 'â˜… '; color: rgb(var(--glow-light-rgb));
            font-weight: bold; display: inline-block;
            width: 1.5em; margin-left: -1.5em;
        }
        #changelog-list.list-pellet li::before { content: none; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div id="grid-background"></div>
    <div id="wandering-rabbit" title="I'm a wandering pixel rabbit!">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8" fill="currentColor"><rect x="1" y="0" width="1" height="1"/><rect x="3" y="0" width="1" height="1"/><rect x="0" y="1" width="1" height="1"/><rect x="4" y="1" width="1" height="1"/><rect x="0" y="2" width="1" height="1"/><rect x="6" y="2" width="1" height="1"/><rect x="0" y="3" width="1" height="1"/><rect x="6" y="3" width="1" height="1"/><rect x="0" y="4" width="1" height="1"/><rect x="6" y="4" width="1" height="1"/><rect x="2" y="2" width="1" height="1"/><rect x="3" y="2" width="1" height="1"/><rect x="2" y="3" width="1" height="1"/><rect x="3" y="3" width="1" height="1"/><rect x="1" y="5" width="1" height="1"/><rect x="2" y="5" width="1" height="1"/><rect x="3" y="5" width="1" height="1"/><rect x="4" y="5" width="1" height="1"/><rect x="5" y="5" width="1" height="1"/></svg>
    </div>
    <div id="scanline-overlay"></div>

    <div class="main-container w-full max-w-7xl rounded-2xl shadow-2xl overflow-hidden transition-all duration-500 glow-border">
        <div class="px-4 py-2 flex items-center justify-between border-b" style="border-color: rgba(var(--glow-rgb), 0.3)">
            <p class="font-pixel text-xs sm:text-sm tracking-widest glow-text">BCC_SYS_v7.0.6_TRON <span style="font-size: 0.75em;">Presented by CanguroMIO & Bunny CC</span></p>
            <div class="flex items-center space-x-3 text-gray-400">
                <button title="æŸ¥çœ‹æ›´æ–°æ—¥å¿—" onclick="toggleModal('changelog-modal')" class="transition-colors hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg></button>
                <button title="é€‰æ‹©ä¸»é¢˜é¢œè‰²" onclick="toggleModal('theme-modal')" class="transition-colors hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01" /></svg></button>
                <button title="æŸ¥çœ‹æ€§èƒ½ç›‘æµ‹" onclick="toggleModal('performance-modal')" class="transition-colors hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg></button>
                <button title="åˆ‡æ¢å…¨å±æ¨¡å¼" onclick="toggleFullscreen()" class="transition-colors hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 0h-4m4 0l-5-5" /></svg></button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 p-6">
            <div class="lg:col-span-1 p-6 flex flex-col space-y-8 ui-module" style="animation-delay: 0.2s;">
                <div class="text-center">
                    <div class="pacman-container mx-auto glow-border" title="Bunny CC's Profile Picture">
                        <div class="profile-image-wrapper">
                            <img id="profile-pic" src="https://placehold.co/160x160/010409/22d3ee?text=Loading..." onerror="this.onerror=null; this.src='https://placehold.co/160x160/010409/22d3ee?text=Error';" class="w-full h-full object-cover" title="Bunny CC's archive photo">
                        </div>
                    </div>
                    <h1 class="font-pixel text-2xl font-bold mt-4 glow-text">Bunny CC</h1>
                    <p class="text-sm font-pixel" style="color: var(--text-muted-color)">ID: B-20240312</p>
                </div>
                <div class="ui-module" style="animation-delay: 0.4s;">
                    <h2 class="font-pixel text-base pb-2 mb-4 glow-text" style="border-bottom: 1px solid rgba(var(--glow-rgb), 0.3)">Milestones</h2>
                    <div id="timing" class="space-y-2 text-sm whitespace-pre-line leading-relaxed list-pellet" style="color: var(--text-muted-color)"></div>
                </div>
            </div>

            <div class="lg:col-span-2 p-6 space-y-6">
                <div class="ui-module" style="animation-delay: 0.6s;">
                    <h2 class="font-pixel text-base pb-2 mb-4 glow-text" style="border-bottom: 1px solid rgba(var(--glow-rgb), 0.3)">Weight Curve</h2>
                    <div class="h-64"><canvas id="weightChart" title="Bunny CC's weight change chart"></canvas></div>
                    <div id="weight-change-info" class="mt-4 text-center p-3 rounded-lg h-12 flex items-center justify-center text-sm" style="background-color: rgba(var(--glow-rgb), 0.05); border: 1px solid rgba(var(--glow-rgb), 0.2)"></div>
                </div>
                <div class="ui-module" style="animation-delay: 0.8s;">
                    <h2 class="font-pixel text-base pb-2 mb-4 glow-text" style="border-bottom: 1px solid rgba(var(--glow-rgb), 0.3)">Data Stream</h2>
                    <div id="all-records-container" class="record-scrollbar h-56 overflow-y-auto pr-2 space-y-3 text-sm" title="All pet activity records"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="changelog-modal" class="modal-overlay fixed inset-0 z-50 hidden items-center justify-center" onclick="toggleModal('changelog-modal')">
        <div class="main-container glow-border w-11/12 max-w-2xl modal-content-base" onclick="event.stopPropagation()" title="Changelog Modal">
            <h2 class="font-pixel text-lg p-4 glow-text border-b" style="border-color:rgba(var(--glow-rgb), 0.3)">Changelog</h2>
            <div class="p-6 max-h-[70vh] overflow-y-auto record-scrollbar" id="changelog-list"></div>
        </div>
    </div>
    <div id="theme-modal" class="modal-overlay fixed inset-0 z-50 hidden items-center justify-center" onclick="toggleModal('theme-modal')">
        <div class="main-container glow-border w-11/12 max-w-md modal-content-base" onclick="event.stopPropagation()" title="Theme Selection Modal">
            <h2 class="font-pixel text-lg p-4 glow-text border-b" style="border-color:rgba(var(--glow-rgb), 0.3)">Color Cycle</h2>
            <div id="theme-grid" class="p-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4"></div>
        </div>
    </div>
    <div id="performance-modal" class="modal-overlay fixed inset-0 z-50 hidden items-center justify-center" onclick="toggleModal('performance-modal')">
        <div class="main-container glow-border w-11/12 max-w-lg modal-content-base" onclick="event.stopPropagation()" title="Performance Monitor Modal">
            <h2 class="font-pixel text-lg p-4 glow-text border-b" style="border-color:rgba(var(--glow-rgb), 0.3)">Performance Monitor</h2>
            <div class="p-6 max-h-[70vh] overflow-y-auto record-scrollbar" id="performance-metrics">
                <p class="text-sm" style="color: var(--text-muted-color);">Click the button to fetch real-time data.</p>
                <button onclick="displayPerformanceMetrics()" class="mt-4 px-4 py-2 rounded-md font-bold text-white transition-colors duration-200" style="background-color: rgb(var(--glow-rgb)); hover:background-color: rgba(var(--glow-rgb), 0.8);" title="Fetch browser performance data">Fetch Performance Data</button>
                <div id="performance-data-output" class="mt-4 space-y-2 text-sm" style="color: var(--text-color);"></div>
                <p class="text-xs mt-4 text-red-400">Note: For security and privacy, browsers do not allow direct access to CPU/GPU usage or your public IP address.</p>
            </div>
        </div>
    </div>

    <script>
        const CONFIG = {
            PROFILE_PIC_PATH: 'dist/Bunny CC_Profile.JPG',
            PET_RECORDS_PATH: 'dist/bunnycc/PetRecords.json',
            START_DATE: '2024/03/12 00:00:00',
            THEMES: [
                { name: 'Cyan', rgb: '34, 211, 238', light_rgb: '103, 232, 249'}, { name: 'Magenta', rgb: '244, 114, 182', light_rgb: '249, 168, 212'},
                { name: 'Lime', rgb: '132, 204, 22', light_rgb: '163, 230, 53'}, { name: 'Orange', rgb: '249, 115, 22', light_rgb: '251, 146, 60'},
                { name: 'Yellow', rgb: '251, 191, 36', light_rgb: '252, 211, 77'}, { name: 'Red', rgb: '239, 68, 68', light_rgb: '248, 113, 113'},
                { name: 'Indigo', rgb: '88, 86, 214', light_rgb: '129, 140, 248'}, { name: 'Green', rgb: '34, 197, 94', light_rgb: '74, 222, 128'},
                { name: 'White', rgb: '229, 231, 235', light_rgb: '243, 244, 246'}, { name: 'Purple', rgb: '168, 85, 247', light_rgb: '192, 132, 252'},
                { name: 'Gold', rgb: '255, 215, 0', light_rgb: '255, 228, 77'}, { name: 'Teal', rgb: '0, 128, 128', light_rgb: '0, 168, 168'},
                { name: 'Coral', rgb: '255, 127, 80', light_rgb: '255, 160, 122'}, { name: 'Sky Blue', rgb: '135, 206, 235', light_rgb: '173, 216, 230'},
                { name: 'Rose', rgb: '255, 0, 127', light_rgb: '255, 51, 153'}, { name: 'Electric Blue', rgb: '125, 249, 255', light_rgb: '173, 255, 255'},
                { name: 'Deep Pink', rgb: '255, 20, 147', light_rgb: '255, 105, 180'}, { name: 'Spring Green', rgb: '0, 255, 127', light_rgb: '127, 255, 212'},
                { name: 'Fire Orange', rgb: '255, 87, 51', light_rgb: '255, 139, 90'}, { name: 'Violet', rgb: '238, 130, 238', light_rgb: '221, 160, 221'},
                { name: 'Forest Green', rgb: '34, 139, 34', light_rgb: '60, 179, 113'}, { name: 'Royal Blue', rgb: '65, 105, 225', light_rgb: '100, 149, 237'},
                { name: 'Hot Pink', rgb: '255, 105, 180', light_rgb: '255, 140, 200'}, { name: 'Goldenrod', rgb: '218, 165, 32', light_rgb: '255, 193, 7'},
                { name: 'Dark Orchid', rgb: '153, 50, 204', light_rgb: '186, 85, 211'}
            ]
        };

        let weightChart = null, allRecordsData = [], weightChartData = [], ui = {}; 
        let wanderingRabbit, targetX, targetY, lastFrameTime = 0;
        const droppingsPool = [], MAX_DROPPINGS = 70, DROP_INTERVAL_MS = 200;
        let currentDroppingIndex = 0, lastDropTime = 0;

        document.addEventListener('DOMContentLoaded', () => {
            ui = {
                profilePic: document.getElementById('profile-pic'), timing: document.getElementById('timing'),
                weightChartCanvas: document.getElementById('weightChart'), weightChangeInfo: document.getElementById('weight-change-info'),
                allRecordsContainer: document.getElementById('all-records-container'), changelogModal: document.getElementById('changelog-modal'),
                themeModal: document.getElementById('theme-modal'), performanceModal: document.getElementById('performance-modal'), 
                changelogList: document.getElementById('changelog-list'), themeGrid: document.getElementById('theme-grid'),
                performanceDataOutput: document.getElementById('performance-data-output'),
            };

            if (ui.profilePic) ui.profilePic.src = CONFIG.PROFILE_PIC_PATH;
            setInterval(updateTiming, 100);
            loadAndProcessData();
            generateThemeSwatches();

            wanderingRabbit = document.getElementById('wandering-rabbit');
            if (wanderingRabbit) {
                wanderingRabbit.style.transform = `translate(${Math.random() * window.innerWidth}px, ${Math.random() * window.innerHeight}px)`;
                for (let i = 0; i < MAX_DROPPINGS; i++) {
                    const d = document.createElement('div');
                    d.className = 'rabbit-dropping';
                    document.body.appendChild(d);
                    droppingsPool.push(d);
                }
                requestAnimationFrame(animateRabbitLoop);
            }
            populateChangelog();
            changeTheme(CONFIG.THEMES[Math.floor(Math.random() * CONFIG.THEMES.length)]);
        });

        function toggleModal(modalId) {
            const modal = document.getElementById(modalId);
            if(modal) {
                modal.classList.toggle('hidden');
                modal.classList.toggle('flex');
                if (modalId === 'performance-modal' && modal.classList.contains('flex')) displayPerformanceMetrics();
            }
        }
        function changeTheme(theme) {
            const docEl = document.documentElement;
            docEl.style.setProperty('--glow-rgb', theme.rgb);
            docEl.style.setProperty('--glow-light-rgb', theme.light_rgb);
            docEl.style.setProperty('--surface-color', `rgba(${theme.rgb}, 0.08)`);
            if (weightChart) renderWeightChart();
        }
        function generateThemeSwatches() {
            if (!ui.themeGrid) return;
            ui.themeGrid.innerHTML = '';
            CONFIG.THEMES.forEach(theme => {
                const s = document.createElement('button');
                s.className = "h-12 w-full rounded-md transition-all duration-200 hover:scale-110 hover:shadow-lg focus:ring-2 ring-offset-2";
                s.style.cssText = `background-color:rgb(${theme.rgb});box-shadow:0 0 15px rgba(${theme.rgb},.5);ring-color:rgb(${theme.rgb});ring-offset-color:var(--bg-color)`;
                s.title = `åˆ‡æ¢åˆ° ${theme.name} ä¸»é¢˜`;
                s.onclick = () => changeTheme(theme);
                ui.themeGrid.appendChild(s);
            });
        }
        function toggleFullscreen() {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen().catch(err => console.error(err));
            else document.exitFullscreen();
        }
        async function displayPerformanceMetrics() {
            if (!ui.performanceDataOutput) return;
            let html = '<h3>Page Load Times:</h3>';
            const nav = performance.getEntriesByType("navigation")[0];
            if(nav) html += `<p><strong>DOM Content Loaded:</strong> ${(nav.domContentLoadedEventEnd - nav.domContentLoadedEventStart).toFixed(2)} ms</p>`;
            html += '<h3 class="mt-4">Hardware & Connection:</h3>';
            html += `<p><strong>Logical CPU Cores:</strong> ${navigator.hardwareConcurrency || 'N/A'}</p>`;
            if (navigator.deviceMemory) html += `<p><strong>Device Memory (est.):</strong> ${navigator.deviceMemory} GB</p>`;
            html += `<p><strong>Screen Resolution:</strong> ${screen.width}x${screen.height}</p>`;
            if (navigator.connection) html += `<p><strong>Connection Type:</strong> ${navigator.connection.effectiveType || 'N/A'}</p>`;
            html += `<h3 class="mt-4">Browser & System:</h3><p><strong>User Agent:</strong> ${navigator.userAgent}</p>`;
            ui.performanceDataOutput.innerHTML = html;
        }
        function updateTiming() {
            const elapsedMs = new Date().getTime() - new Date(CONFIG.START_DATE).getTime();
            const days = (elapsedMs / 86400000).toFixed(3);
            const secs = Math.floor(elapsedMs / 1000);
            if (ui.timing) ui.timing.innerHTML = `<ul><li>ğŸ°Bunny CC has arrived for ${days} days</li><li>ğŸ‚Total uptime: ${Math.floor(secs/3600)}h ${Math.floor(secs%3600/60)}m ${secs%60}s</li></ul>`;
        }
        async function loadAndProcessData() {
            if (!ui.allRecordsContainer) return;
            ui.allRecordsContainer.innerHTML = `<p class="text-center">Loading Archive...</p>`;
            try {
                const res = await fetch(CONFIG.PET_RECORDS_PATH);
                if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
                const records = await res.json();
                allRecordsData = records.map(r => ({ ...r, processedDate: new Date((Math.floor(r.date) * 1000) + 978307200000) })).sort((a,b) => b.processedDate-a.processedDate); // 31 years offset in ms
                weightChartData = allRecordsData.filter(r => r.activity === 'ä½“é‡æµ‹é‡' && typeof r.weight === 'number').map(r=>({date:r.processedDate, weight:r.weight})).sort((a,b) => a.date-b.date);
                renderAllRecords();
                renderWeightChart();
            } catch (error) {
                console.error("Data load error:", error);
                ui.allRecordsContainer.innerHTML = `<p class="text-red-400 text-center">Error: Archive failed to load. Check path: '${CONFIG.PET_RECORDS_PATH}'.</p>`;
            }
        }
        function renderAllRecords() {
            if (!ui.allRecordsContainer) return;
            ui.allRecordsContainer.innerHTML = allRecordsData.map(r => `<div class="p-3 rounded-md" style="background:rgba(var(--glow-rgb),.05);border-left:3px solid rgba(var(--glow-rgb),.5)"><div class="flex justify-between items-center"><strong class="glow-text text-sm">${r.activity}</strong><time class="text-xs" style="color:var(--text-muted-color)">${r.processedDate.toLocaleDateString('zh-CN')}</time></div><p class="mt-1">${r.notes||'æ— å¤‡æ³¨'}</p></div>`).join('');
        }
        function renderWeightChart() {
            if (!ui.weightChartCanvas) return;
            if (weightChart) weightChart.destroy();
            if (!weightChartData.length) { ui.weightChartCanvas.style.display = 'none'; return; }
            ui.weightChartCanvas.style.display = 'block';
            const style = getComputedStyle(document.documentElement);
            const primaryColor = `rgb(${style.getPropertyValue('--glow-rgb').trim()})`, textColor = style.getPropertyValue('--text-muted-color').trim(), gridColor = `rgba(${style.getPropertyValue('--glow-rgb').trim()},0.1)`;
            weightChart = new Chart(ui.weightChartCanvas.getContext('2d'), { type: 'line', data: { labels: weightChartData.map(d=>d.date.toLocaleDateString('zh-CN')), datasets: [{ label:'Weight(g)', data:weightChartData.map(d=>d.weight), borderColor:primaryColor, borderWidth:2, pointRadius:4, tension:0.4, fill:true }] }, options: { responsive:true, maintainAspectRatio:false, plugins:{legend:{display:false}}, scales:{y:{grid:{color:gridColor},ticks:{color:textColor}},x:{grid:{display:false},ticks:{color:textColor}}} }});
        }
        function animateRabbitLoop(t) {
            if (lastFrameTime === 0) lastFrameTime = t;
            const delta = t - lastFrameTime; lastFrameTime = t;
            animateRabbit(delta); requestAnimationFrame(animateRabbitLoop);
        }
        function animateRabbit(delta) {
            if (!wanderingRabbit) return;
            const speed = 100 * (delta / 1000); // pixels/sec
            const transform = new DOMMatrix(getComputedStyle(wanderingRabbit).transform);
            let cx = transform.m41, cy = transform.m42;
            if (targetX === undefined || Math.hypot(targetX - cx, targetY - cy) < speed) {
                targetX = Math.random() * (window.innerWidth - 72); targetY = Math.random() * (window.innerHeight - 72);
            }
            const dx = targetX - cx, dy = targetY - cy, dist = Math.hypot(dx, dy);
            if (dist > 0) { cx += (dx / dist) * speed; cy += (dy / dist) * speed; }
            wanderingRabbit.style.transform = `translate(${cx}px, ${cy}px)`;
            if (performance.now() - lastDropTime > DROP_INTERVAL_MS) {
                const d = droppingsPool[currentDroppingIndex];
                if(d){ d.style.left=`${cx+33}px`; d.style.top=`${cy+46}px`; d.classList.remove('fade-out'); void d.offsetWidth; d.classList.add('fade-out'); currentDroppingIndex=(currentDroppingIndex+1)%MAX_DROPPINGS; lastDropTime=performance.now(); }
            }
        }
        window.addEventListener('resize', () => { if (!wanderingRabbit) return; const t = new DOMMatrix(getComputedStyle(wanderingRabbit).transform); wanderingRabbit.style.transform = `translate(${Math.min(t.m41,window.innerWidth-72)}px, ${Math.min(t.m42,window.innerHeight-72)}px)`; targetX = Math.random()*(window.innerWidth-72); targetY = Math.random()*(window.innerHeight-72); });

        function populateChangelog() {
            if (!ui.changelogList) return;
            ui.changelogList.innerHTML = `
                <h4>âœ¨ v7.0.6 - ğŸ“œ The Bard's Rabbit (åŸæ¸¸è¯—å…”)</h4>
                <div class="changelog-entry">
                    <p><strong>A New Decree! (æ–°è°•ï¼Œæ˜­å‘Šå¤©ä¸‹ï¼):</strong></p>
                    <ul>
                        <li>Behold, a new Appellation! The archive is henceforth christened "The Bard's Rabbit", in honour of this grandiloquent transformation. (æ–°å·ï¼Œèµ«ç„¶åœ¨ç›®ï¼æ­¤å·å®—ä»Šå·²åŠ å†•ï¼Œå·æ›°â€œåŸæ¸¸è¯—å…”â€ï¼Œä»¥å½°å…¶æ–‡é‡‡ç„•ç„¶ä¹‹å˜ã€‚)</li>
                    </ul>
                    <p><strong>Sublime Refinements! (åŒ å¿ƒï¼Œç²¾ç›Šæ±‚ç²¾ï¼):</strong></p>
                    <ul>
                        <li>The very tongue of the chronicles hath been transmuted! Every entry, past and present, now speaks in the noble cadence of the Bard, its prose as rich as a midsummer's dream. (å²å†Œä¹‹è¨€è¾ï¼Œä»Šå·²åŒ–å¢ƒï¼è¿‡å¾€ä»Šæ¥ï¼Œå­—å­—ç ç‘ï¼Œçš†ä»¥éªšäººä¹‹é›…éŸµåŸå’ï¼Œå…¶æ–‡é‡‡æ–ç„¶ï¼Œå¦‚ä»²å¤å¤œä¹‹æ¢¦ã€‚)</li>
                        <li>The head-scripts of our sacred chambers, once writ in the common tongue of the East, now stand proclaimed in English, for clarity across all realms. (æ®¿å ‚ä¹‹æ ‡ï¼Œä»Šæ˜“è¥¿æ–‡ã€‚æ˜”æ—¥ä¸œæ–¹ä¹‹è¯­ï¼Œä»Šæ¢è‹±æ ¼åˆ©ä¹‹è¨€ï¼Œä»¥æ±‚å››æµ·ä¹‹å†…ï¼Œè§‚è€…çš†æ˜ã€‚)</li>
                    </ul>
                    <p><strong>Maladies Mended! (æ—§ç–¾ï¼Œä»Šå·²ç—Šæ„ˆï¼):</strong></p>
                    <ul>
                         <li>The celestial map to our treasured data-hoard hath been corrected. The fetcher's gaze, no longer astray, now finds its trove at 'dist/bunnycc/PetRecords.json' with unerring grace. (å®åº“ä¹‹å¤©å›¾ï¼Œä»Šå·²å½’æ­£ã€‚å¯»è¸ªè€…ä¹‹ç›®å…‰ï¼Œä¸å†è¿·ç¦»ï¼Œç²¾å‡†æ— è¯¯ï¼Œç›´æŠµ 'dist/bunnycc/PetRecords.json' ä¹‹æ‰€åœ¨ã€‚)</li>
                    </ul>
                </div>
                <h4>âœ¨ v7.0.5 - ğŸŒŒ ProMotion Rabbit (ProMotionä¹‹å…”)</h4>
                <div class="changelog-entry">
                    <p><strong>A New Decree! (æ–°è°•ï¼Œæ˜­å‘Šå¤©ä¸‹ï¼):</strong></p>
                    <ul>
                        <li>The Oracle's Gaze Deepened! Our performance monitor now doth reveal further secrets of the machine's heart and its tether to the world, showing forth the number of its thinking cores, its memory's vastness, the screen's own measure, and the nature of its worldly connection. (å…ˆçŸ¥ä¹‹çœ¼ï¼Œæ´æ‚‰æ›´æ·±ï¼ä»Šæ€§èƒ½ç›‘å¯Ÿä¹‹æ³•ï¼Œå¯çª¥æœºå…³ä¹‹å¿ƒã€å°˜ä¸–ä¹‹ç½‘ï¼Œå°½æ˜¾å…¶æ€ç»ªä¹‹æ ¸ã€è®°å¿†ä¹‹æ¸Šã€æ˜é•œä¹‹å°ºã€åŠç½‘ç»œä¹‹å½¢ã€‚)</li>
                    </ul>
                    <p><strong>Sublime Refinements! (åŒ å¿ƒï¼Œç²¾ç›Šæ±‚ç²¾ï¼):</strong></p>
                    <ul>
                        <li>A Dance Unchained by Time! The animations, once bound to sixty turns of the glass per second, are now set free. On screens of ProMotion's grace, they shall dance at a pace twice as swift, yet lose naught of their measured tread on common glass. (å…‰é˜´ä¹‹èˆï¼ŒæŒ£è„±æ·é”ï¼åŠ¨ç”»ä¹‹å¾‹ï¼Œæ˜”ä¸ºç§’é—´å…­åä¹‹é™ï¼Œä»Šå·²å…¨ç„¶è§£æ”¾ã€‚äºProMotionä¹‹å±ï¼Œå…¶èˆé€Ÿå€å¢ï¼Œç„¶äºå‡¡å±ä¹‹ä¸Šï¼Œæ­¥å±¥ä¾ç„¶ä»å®¹ã€‚)</li>
                        <li>The Aether's Hue, More Lively Still! The background's celestial ballet hath been taught new, more wondrous steps, its motion now a thing of greater randomness and silken grace. (è‹ç©¹ä¹‹è‰²ï¼Œæ„ˆå‘çµåŠ¨ï¼èƒŒæ™¯ä¹‹å¤©èˆï¼Œå·²ä¹ å¾—æ–°å¥‡ä¹‹æ­¥æ³•ï¼Œå…¶è¸ªå½±æ„ˆå‘é£˜å¿½ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘ã€‚)</li>
                        <li>Whispers for the Inquisitive! Upon every sigil and button that doth invite a click, a title now whispers its purpose, a boon to the curious soul. (æ™ºè€…ä¹‹è¯­ï¼Œç‚¹çŸ³æˆé‡‘ï¼å‡¡å¯ç‚¹ä¹‹ç¬¦å°ï¼Œçš†é™„å…¶åï¼Œä»¥å‘Šå…¶ç”¨ï¼Œä¾¿è§ˆè€…ä¹‹å¿ƒã€‚)</li>
                        <li>A Scribe's International Hand! The archive's title and its keeper's name, once writ in the script of the Orient, now stand in the Roman tongue, a first step toward all nations. (ä¹¦è€…ä¹‹ç¬”ï¼Œæ”¾çœ¼å››æµ·ï¼æ¡ˆå·ä¹‹åï¼Œå¸æŒè€…ä¹‹å·ï¼Œæ˜”ä¸ºä¸œæ–¹ä¹‹æ–‡ï¼Œä»Šæ”¹ç½—é©¬ä¹‹å­—ï¼Œæ­¤ä¹ƒé€šè¾¾ä¸‡å›½ä¹‹å§‹ã€‚)</li>
                    </ul>
                    <p><strong>Maladies Mended! (æ—§ç–¾ï¼Œä»Šå·²ç—Šæ„ˆï¼):</strong></p>
                    <ul>
                        <li>The Phantom of the Dropping, Banished! A vexing error, `DROP_INTERVAL_MS is not defined`, which did plague the console with ceaseless cries, hath been smote and cast into the void. The rabbit's trail is once more whole. (é­…å½±æ— è¸ªï¼Œæ—§ç–¾ç—Šæ„ˆï¼`DROP_INTERVAL_MS` ä¹‹è°¬ï¼Œæ˜”æ—¥äºç¥æœºå°å“€åšä¸ç»ï¼Œä»Šå·²ä¸€å‡»è€Œæ•£ï¼Œç°é£çƒŸç­ã€‚ç‰å…”ä¹‹è¸ªï¼Œå¤å½’äº•ç„¶ã€‚)</li>
                    </ul>
                </div>
                <h4>âœ¨ v7.0.4 - ğŸŒŒ Star Sea Roaming Rabbit (æ˜Ÿæµ·æ¼«æ¸¸å…”)</h4>
                <div class="changelog-entry">
                     <p><strong>A New Decree! (æ–°è°•ï¼Œæ˜­å‘Šå¤©ä¸‹ï¼):</strong></p>
                     <ul>
                        <li>A Patron's Mark! Beside the version's sacred number, a new legend is writ: "Presented by CanguroMIO & Bunny CC," a tribute to its creators. (å®ˆæŠ¤è€…ä¹‹å°è®°ï¼äºç‰ˆæœ¬å·ä¹‹æ—ï¼Œé“­æ–‡æ›°ï¼šâ€œç”±CanguroMIOä¸å…”å¯å¯è”åˆå‘ˆç°â€ï¼Œä»¥å½°å…¶åˆ›é€ è€…ä¹‹åŠŸã€‚)</li>
                     </ul>
                     <p><strong>Sublime Refinements! (åŒ å¿ƒï¼Œç²¾ç›Šæ±‚ç²¾ï¼):</strong></p>
                     <ul>
                        <li>The Swiftness of Safari! For those who browse within the orchard's walled garden, a hint is given to the engine, that it may prepare for a display of most fluid and graceful motion. (Safariä¹‹è¿…æ·ï¼å‡¡ä»¥å¾¡å›­ä¹‹å™¨æ¸¸è§ˆè€…ï¼Œæœ•å·²æˆå¼•æ“ä»¥æœºå®œï¼Œå¤‡å±•æµç•…åç¾ä¹‹å§¿ã€‚)</li>
                     </ul>
                     <p><strong>Maladies Mended! (æ—§ç–¾ï¼Œä»Šå·²ç—Šæ„ˆï¼):</strong></p>
                     <ul>
                         <li>The Lost Scrolls Found! The lamentable cry, "Error: Archive failed to load," is silenced. The `content_fetcher` now doth safely retrieve the `PetRecords.json`, and the tales within are no longer lost to the aether. (å¤±è½ä¹‹å·ï¼Œç‰©å½’åŸä¸»ï¼â€œé”™è¯¯ï¼šæ¡£æ¡ˆåŠ è½½å¤±è´¥â€ä¹‹å“€é¸£å·²æ¯ã€‚ä»Š `content_fetcher` å¯å®‰ç„¶å¯»å› `PetRecords.json`ï¼Œå·ä¸­æ•…äº‹ï¼Œä¸å†æ•£äºè™šç©ºã€‚)</li>
                    </ul>
                </div>
                 <h4>âœ¨ v7.0.0 - ğŸŒ  Luminous Fusion Rabbit (èå…‰å¹»å¢ƒå…”)</h4>
                <div class="changelog-entry">
                    <p><strong>A New Decree! (æ–°è°•ï¼Œæ˜­å‘Šå¤©ä¸‹ï¼):</strong></p>
                    <ul>
                        <li>The Oracle of Performance now stands revealed! A button, newly forged, doth summon forth a tableau revealing the browser's vital humours, specifically its memory's embrace, thereby granting insight into the digital essence's consumption. (æ€§èƒ½ç›‘å¯Ÿï¼Œæ´æ‚‰è™šå®ï¼šæ–°å¢â€œæ€§èƒ½ç›‘å¯Ÿâ€ä¹‹é’®ï¼Œå¯å³æ—¶è§ˆé˜…æµè§ˆå™¨è®°å¿†è€—ç”¨ç­‰æ•°æ®ï¼ŒåŠ©å›æ˜å¯Ÿç§‹æ¯«ã€‚)</li>
                    </ul>
                    <p><strong>Sublime Refinements! (åŒ å¿ƒï¼Œç²¾ç›Šæ±‚ç²¾ï¼):</strong></p>
                    <ul>
                        <li>The visage's interplay now heightened: Upon the mouse's approach, the Pac-Man's maw doth gape with greater vigour, and a radiant flash illuminates the portrait's bounds, thereby elevating the interactive marvel. (é¢å®¹äº’åŠ¨ï¼Œçµå…‰ä¹ç°ï¼šé¼ æ ‡è½»æŠšï¼ŒPac-Man ä¹‹å£æ›´æ˜¾æ´»æ³¼ï¼Œå¤´åƒè¾¹ç¼˜éšä¹‹é—ªè€€ï¼Œäº¤äº’ä¹‹é—´ï¼ŒçµåŠ¨ä¹‹æ„Ÿæ²¹ç„¶è€Œç”Ÿã€‚)</li>
                        <li>The Canvas of Aetherial Radiance now adorned: The web's backdrop embraceth a dynamic radial gradient, its hues meticulously woven with the chosen theme's palette, shifting subtly as if breathing, thus forging a deeper, more artistic vista. (èƒŒæ™¯å…‰å½±ï¼Œè‰ºæœ¯äº¤ç»‡ï¼šç½‘é¡µèƒŒæ™¯æµåŠ¨å…‰å½±ï¼Œä¸é€‰å®šä¸»é¢˜è‰²äº¤èï¼Œè¥é€ æ·±é‚ƒè‰ºæœ¯æ°”éŸµã€‚æ¨¡å—é¢æ¿äº¦é€å…‰æ˜ ä¸»é¢˜ï¼Œè‰²æ³½äº¤å ï¼Œé›…è‡´å€å¢ã€‚)</li>
                        <li>The errant Hare's gambol now flows with fluid grace: The elusive rabbit's peregrinations across the display, once plagued by stuttering, now proceed with an unblemished rhythm, infusing the archive with newfound vivacity. (ç‰å…”è·ƒåŠ¨ï¼Œè¡Œäº‘æµæ°´ï¼šä¿®å¤å…”åŠ¨ç”»ä¹‹æ»ç¢ï¼Œä»Šå…¶è½»ç›ˆæ¼«æ­¥ï¼Œä¸ºæ¡£æ¡ˆæ³¨å…¥å‹ƒå‹ƒç”Ÿæœºã€‚)</li>
                    </ul>
                    <p><strong>Maladies Mended! (æ—§ç–¾ï¼Œä»Šå·²ç—Šæ„ˆï¼):</strong></p>
                    <ul>
                        <li>The Chronicle of Changes, once shrouded in silence, now unfurls in its entirety. The malady of blank entries hath been utterly dispelled, and the annals of transformation stand complete, preserving every epochal shift. (æ›´æ–°æ—¥å¿—ï¼Œæ— è”½æ˜¾ç°ï¼šè§£å†³æ—¥å¿—ç©ºç™½ä¹‹å›°ï¼Œæ‰€æœ‰å†å²è®°å½•ï¼Œæ˜­ç„¶è‹¥æ­ã€‚)</li>
                    </ul>
                </div>
            `;
        }
    </script>
</body>
</html>
