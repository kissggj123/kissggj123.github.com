<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ° Bunny CC's Archive v7.0.7 - Holo-Interface Rabbit</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --glow-rgb: 34, 211, 238; --glow-light-rgb: 103, 232, 249;
            --bg-color: #010409; --surface-color: rgba(var(--glow-rgb), 0.08);
            --grid-color: rgba(var(--glow-rgb), 0.15); --text-color: #e6edf3;
            --text-muted-color: #8b949e; --grad-pos-x: 20%; --grad-pos-y: 20%;
        }
        body {
            font-family: 'Noto Sans SC', sans-serif; background-color: var(--bg-color);
            color: var(--text-color); overflow-x: hidden; opacity: 0;
            animation: fadeIn 1s ease 0.5s forwards; position: relative;
        }
        .font-pixel { font-family: 'Press Start 2P', cursive; }
        .glow-text { color: rgb(var(--glow-light-rgb)); text-shadow: 0 0 8px rgba(var(--glow-rgb), 0.8), 0 0 16px rgba(var(--glow-rgb), 0.5); }
        .glow-border { 
            border: 1px solid rgba(var(--glow-rgb), 0.4); 
            box-shadow: 0 0 12px rgba(var(--glow-rgb), 0.2), inset 0 0 8px rgba(var(--glow-rgb), 0.15);
            animation: pulse-border 4s infinite ease-in-out;
        }
        #grid-background {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2;
            background-image:
                radial-gradient(circle at var(--grad-pos-x) var(--grad-pos-y), rgba(var(--glow-rgb), 0.08) 0%, rgba(1,4,9,0.9) 60%),
                linear-gradient(rgba(var(--glow-rgb), 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(var(--glow-rgb), 0.1) 1px, transparent 1px),
                linear-gradient(rgba(var(--glow-rgb), 0.05) 2px, transparent 2px),
                linear-gradient(90deg, rgba(var(--glow-rgb), 0.05) 2px, transparent 2px);
            background-size: cover, 50px 50px, 50px 50px, 100px 100px, 100px 100px;
            animation: pan-grid 20s linear infinite, radial-move 45s ease-in-out infinite alternate;
        }
        #scanline-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; pointer-events: none;
            background: linear-gradient(to bottom, rgba(18,18,18,0) 50%, rgba(0,0,0,0.25) 50%);
            background-size: 100% 4px; animation: scanline-move 10s linear infinite;
        }
        .main-container {
            background-color: var(--surface-color); backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px); min-height: 80vh; position: relative;
        }
        .ui-module { 
            position: relative; opacity: 0; transform: translateY(20px); 
            animation: module-boot 0.5s ease forwards; background-color: transparent;
            border: 1px solid rgba(var(--glow-rgb), 0.2);
            padding: 1.5rem;
        }
        /* Corner Brackets for tech feel */
        .ui-module::before, .ui-module::after {
            content: ''; position: absolute; width: 20px; height: 20px;
            border-color: rgb(var(--glow-light-rgb)); border-style: solid;
            transition: all 0.3s ease;
        }
        .ui-module::before { top: -2px; left: -2px; border-width: 2px 0 0 2px; }
        .ui-module::after { bottom: -2px; right: -2px; border-width: 0 2px 2px 0; }
        
        .modal-overlay { background-color: rgba(0,0,0,0.7); backdrop-filter: blur(4px); z-index: 1000; }
        .modal-content-base { background-color: var(--surface-color); }
        
        /* Text Glitch/Type-in effect */
        .title-type-in {
            display: inline-block;
            overflow: hidden; white-space: nowrap;
            border-right: .1em solid rgb(var(--glow-light-rgb));
            animation: typing 1.5s steps(30, end), blink-caret .75s step-end infinite;
            width: 0;
        }
        @keyframes typing { from { width: 0 } to { width: 100% } }
        @keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: rgb(var(--glow-light-rgb)); } }
        @keyframes pulse-border { 0%, 100% { box-shadow: 0 0 12px rgba(var(--glow-rgb), 0.2), inset 0 0 8px rgba(var(--glow-rgb), 0.15); } 50% { box-shadow: 0 0 20px rgba(var(--glow-rgb), 0.4), inset 0 0 14px rgba(var(--glow-rgb), 0.25); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pan-grid { from { background-position: 0 0; } to { background-position: -100px -100px; } }
        @keyframes scanline-move { from { background-position: 0 0; } to { background-position: 0 100%; } }
        @keyframes module-boot { to { opacity: 1; transform: translateY(0); } }
        @keyframes radial-move { 0% { --grad-pos-x: 15%; --grad-pos-y: 20%; } 25% { --grad-pos-x: 90%; --grad-pos-y: 90%; } 50% { --grad-pos-x: 10%; --grad-pos-y: 85%; } 75% { --grad-pos-x: 85%; --grad-pos-y: 55%; } 100% { --grad-pos-x: 15%; --grad-pos-y: 20%; } }

        /* Other styles */
        .record-scrollbar::-webkit-scrollbar { width: 8px; }
        .record-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .record-scrollbar::-webkit-scrollbar-thumb { background: rgba(var(--glow-rgb), 0.5); border-radius: 4px; }
        #wandering-rabbit { position: fixed; width: 72px; height: 72px; z-index: 90; pointer-events: none; fill: rgb(var(--glow-light-rgb)); filter: drop-shadow(0 0 15px rgba(var(--glow-rgb), 0.8)); will-change: transform; }
        .rabbit-dropping { position: absolute; width: 6px; height: 6px; background-color: #4a2c2a; border-radius: 1px; transform: scale(1); opacity: 1; transition: transform 2s ease-out, opacity 2s ease-out; z-index: 89; pointer-events: none; will-change: transform, opacity; }
        .rabbit-dropping.fade-out { transform: scale(0.2); opacity: 0; }
        .changelog-entry { padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; background-color: rgba(var(--glow-rgb), 0.1); border: 1px solid rgba(var(--glow-rgb), 0.4); }
        .changelog-entry ul { list-style: none; padding-left: 1.5em; }
        .changelog-entry li::before { content: 'â˜… '; color: rgb(var(--glow-light-rgb)); font-weight: bold; display: inline-block; width: 1.5em; margin-left: -1.5em; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div id="grid-background"></div>
    <div id="wandering-rabbit" title="I'm a wandering pixel rabbit!">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8" fill="currentColor"><rect x="1" y="0" width="1" height="1"/><rect x="3" y="0" width="1" height="1"/><rect x="0" y="1" width="1" height="1"/><rect x="4" y="1" width="1" height="1"/><rect x="0" y="2" width="1" height="1"/><rect x="6" y="2" width="1" height="1"/><rect x="0" y="3" width="1" height="1"/><rect x="6" y="3" width="1" height="1"/><rect x="0" y="4" width="1" height="1"/><rect x="6" y="4" width="1" height="1"/><rect x="2" y="2" width="1" height="1"/><rect x="3" y="2" width="1" height="1"/><rect x="2" y="3" width="1" height="1"/><rect x="3" y="3" width="1" height="1"/><rect x="1" y="5" width="1" height="1"/><rect x="2" y="5" width="1" height="1"/><rect x="3" y="5" width="1" height="1"/><rect x="4" y="5" width="1" height="1"/><rect x="5" y="5" width="1" height="1"/></svg>
    </div>
    <div id="scanline-overlay"></div>

    <div class="main-container w-full max-w-7xl rounded-2xl shadow-2xl overflow-hidden transition-all duration-500 glow-border">
        <div class="px-4 py-2 flex items-center justify-between border-b" style="border-color: rgba(var(--glow-rgb), 0.3)">
            <p class="font-pixel text-xs sm:text-sm tracking-widest glow-text">BCC_SYS_v7.0.7_TRON <span style="font-size: 0.75em;">Presented by CanguroMIO & Bunny CC</span></p>
            <div id="header-controls" class="flex items-center space-x-3 text-gray-400">
                <button data-action="toggle-sound" title="åˆ‡æ¢éŸ³æ•ˆ" class="transition-colors hover:text-white"><svg id="sound-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" /></svg></button>
                <button data-action="toggle-modal" data-target="changelog-modal" title="æŸ¥çœ‹æ›´æ–°æ—¥å¿—" class="transition-colors hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg></button>
                <button data-action="toggle-modal" data-target="theme-modal" title="é€‰æ‹©ä¸»é¢˜é¢œè‰²" class="transition-colors hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01" /></svg></button>
                <button data-action="toggle-modal" data-target="performance-modal" title="æŸ¥çœ‹æ€§èƒ½ç›‘æµ‹" class="transition-colors hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg></button>
                <button data-action="toggle-fullscreen" title="åˆ‡æ¢å…¨å±æ¨¡å¼" class="transition-colors hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 0h-4m4 0l-5-5" /></svg></button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 p-6">
            <div class="lg:col-span-1 p-6 flex flex-col space-y-8" style="animation-delay: 0.2s;">
                <div class="text-center">
                    <div class="relative w-40 h-40 mx-auto group">
                        <div class="w-full h-full rounded-full glow-border transition-all duration-300 group-hover:shadow-[0_0_30px_rgba(var(--glow-rgb),0.9),_inset_0_0_20px_rgba(var(--glow-rgb),0.6)]">
                            <img id="profile-pic" src="https://placehold.co/160x160/010409/22d3ee?text=Loading..." onerror="this.onerror=null; this.src='https://placehold.co/160x160/010409/22d3ee?text=Error';" class="w-full h-full object-cover rounded-full" title="Bunny CC's archive photo">
                        </div>
                    </div>
                    <h1 class="font-pixel text-2xl font-bold mt-4 glow-text">Bunny CC</h1>
                    <p class="text-sm font-pixel text-[color:var(--text-muted-color)]">ID: B-20240312</p>
                </div>
                <div class="ui-module" style="animation-delay: 0.4s;">
                    <h2 class="font-pixel text-base pb-2 mb-4 glow-text border-b border-[rgba(var(--glow-rgb),0.3)]"><span class="title-type-in">Milestones</span></h2>
                    <div id="timing" class="space-y-2 text-sm text-[color:var(--text-muted-color)]"></div>
                </div>
            </div>

            <div class="lg:col-span-2 p-6 space-y-6">
                <div class="ui-module" style="animation-delay: 0.6s;">
                    <h2 class="font-pixel text-base pb-2 mb-4 glow-text border-b border-[rgba(var(--glow-rgb),0.3)]"><span class="title-type-in">Weight Curve</span></h2>
                    <div class="h-64"><canvas id="weightChart" title="Bunny CC's weight change chart"></canvas></div>
                </div>
                <div class="ui-module" style="animation-delay: 0.8s;">
                    <h2 class="font-pixel text-base pb-2 mb-4 glow-text border-b border-[rgba(var(--glow-rgb),0.3)]"><span class="title-type-in">Data Stream</span></h2>
                    <div id="all-records-container" class="record-scrollbar h-56 overflow-y-auto pr-2 space-y-3 text-sm" title="All pet activity records"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="changelog-modal" class="modal-overlay fixed inset-0 z-50 hidden items-center justify-center">
        <div class="main-container glow-border w-11/12 max-w-2xl modal-content-base" title="Changelog Modal">
            <h2 class="font-pixel text-lg p-4 glow-text border-b border-[rgba(var(--glow-rgb),0.3)]">Changelog</h2>
            <div class="p-6 max-h-[70vh] overflow-y-auto record-scrollbar" id="changelog-list"></div>
        </div>
    </div>
    <div id="theme-modal" class="modal-overlay fixed inset-0 z-50 hidden items-center justify-center">
        <div class="main-container glow-border w-11/12 max-w-md modal-content-base" title="Theme Selection Modal">
            <h2 class="font-pixel text-lg p-4 glow-text border-b border-[rgba(var(--glow-rgb),0.3)]">Color Cycle</h2>
            <div id="theme-grid" class="p-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4"></div>
        </div>
    </div>
    <div id="performance-modal" class="modal-overlay fixed inset-0 z-50 hidden items-center justify-center">
        <div class="main-container glow-border w-11/12 max-w-lg modal-content-base" title="Performance Monitor Modal">
            <h2 class="font-pixel text-lg p-4 glow-text border-b border-[rgba(var(--glow-rgb),0.3)]">Performance Monitor</h2>
            <div class="p-6 max-h-[70vh] overflow-y-auto record-scrollbar" id="performance-metrics">
                <button id="fetch-perf-btn" class="w-full px-4 py-2 rounded-md font-bold text-white transition-all duration-200" style="background-color: rgb(var(--glow-rgb)); hover:background-color: rgba(var(--glow-rgb), 0.8);" title="Fetch browser performance data">Fetch Performance Data</button>
                <div id="performance-data-output" class="mt-4 space-y-2 text-sm"></div>
            </div>
        </div>
    </div>

    <script>
        const CONFIG = {
            PET_RECORDS_PATH: 'dist/bunnycc/PetRecords.json',
            THEMES: [{name:"Cyan",rgb:"34,211,238",light_rgb:"103,232,249"},{name:"Magenta",rgb:"244,114,182",light_rgb:"249,168,212"},{name:"Lime",rgb:"132,204,22",light_rgb:"163,230,53"},{name:"Orange",rgb:"249,115,22",light_rgb:"251,146,60"},{name:"Yellow",rgb:"251,191,36",light_rgb:"252,211,77"},{name:"Red",rgb:"239,68,68",light_rgb:"248,113,113"},{name:"Indigo",rgb:"88,86,214",light_rgb:"129,140,248"},{name:"Green",rgb:"34,197,94",light_rgb:"74,222,128"},{name:"White",rgb:"229,231,235",light_rgb:"243,244,246"},{name:"Purple",rgb:"168,85,247",light_rgb:"192,132,252"}]
        };

        let weightChart, allRecordsData = [], weightChartData = [], ui = {}, audioCtx, uiSounds = {}, soundEnabled = true, lastFrameTime = 0, wanderingRabbit, targetX, targetY;
        const droppingsPool = [], MAX_DROPPINGS = 50, DROP_INTERVAL_MS = 250;
        let currentDroppingIndex = 0, lastDropTime = 0;

        document.addEventListener('DOMContentLoaded', () => {
            Object.assign(ui, {
                profilePic: document.getElementById('profile-pic'), timing: document.getElementById('timing'),
                weightChartCanvas: document.getElementById('weightChart'), allRecordsContainer: document.getElementById('all-records-container'),
                changelogList: document.getElementById('changelog-list'), themeGrid: document.getElementById('theme-grid'),
                performanceDataOutput: document.getElementById('performance-data-output'),
                headerControls: document.getElementById('header-controls')
            });
            ui.profilePic.src = CONFIG.PROFILE_PIC_PATH;
            
            initAudio();
            setupEventListeners();
            loadAndProcessData();
            generateThemeSwatches();
            
            wanderingRabbit = document.getElementById('wandering-rabbit');
            if (wanderingRabbit) {
                wanderingRabbit.style.transform = `translate(${Math.random()*window.innerWidth}px, ${Math.random()*window.innerHeight}px)`;
                for (let i=0; i<MAX_DROPPINGS; i++) {
                    const d=document.createElement('div'); d.className='rabbit-dropping'; document.body.appendChild(d); droppingsPool.push(d);
                }
                requestAnimationFrame(animateRabbitLoop);
            }
            populateChangelog();
            changeTheme(CONFIG.THEMES[Math.floor(Math.random() * CONFIG.THEMES.length)]);
        });

        function setupEventListeners() {
            ui.headerControls.addEventListener('click', (e) => {
                const button = e.target.closest('button');
                if (!button) return;
                playUISound('click');
                const action = button.dataset.action;
                if (action === 'toggle-modal') toggleModal(button.dataset.target);
                if (action === 'toggle-fullscreen') toggleFullscreen();
                if (action === 'toggle-sound') toggleSound();
            });

            document.getElementById('fetch-perf-btn').addEventListener('click', displayPerformanceMetrics);
            
            // Event delegation for hover sounds
            document.body.addEventListener('mouseover', (e) => {
                if (e.target.closest('button, a')) playUISound('hover');
            });

            // Close modals on overlay click
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) toggleModal(overlay.id);
                });
            });
        }
        
        async function initAudio() {
            try {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                uiSounds = {
                    hover: await createSound('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YAAAAA=='), // Short silent tick
                    click: await createSound('data:audio/wav;base64,UklGRlIAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YUgAAABMS09NRTo6aHR0cHM6Ly93d3cubHVzaGN1bHRzLmNvbS9mcmVlLXNvdW5kLWVmZmVjdHMvAEC9/35/v/9AP39APEA/QD9AP0A/v39/v3+/Pz8/P78/f79/v7+/vz9/Pz9/Pz8/vz9/P3+/fz8/f78/f78/f79/v3+/P3+/Q=='),
                };
            } catch (e) { console.error("Web Audio API is not supported in this browser."); soundEnabled = false; }
        }
        async function createSound(base64) {
            const res = await fetch(base64);
            const arrayBuffer = await res.arrayBuffer();
            return await audioCtx.decodeAudioData(arrayBuffer);
        }
        function playUISound(type) {
            if (!soundEnabled || !audioCtx || !uiSounds[type] || audioCtx.state === 'suspended') return;
            const source = audioCtx.createBufferSource();
            source.buffer = uiSounds[type];
            source.connect(audioCtx.destination);
            source.start(0);
        }
        function toggleSound() {
            soundEnabled = !soundEnabled;
            const icon = document.getElementById('sound-icon');
            icon.innerHTML = soundEnabled ? `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />` : `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l-4-4m0 4l4-4" />`;
            if (soundEnabled && audioCtx.state === 'suspended') audioCtx.resume();
        }
        function toggleModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.toggle('hidden');
                modal.classList.toggle('flex');
            }
        }
        function changeTheme(theme) {
            const docEl = document.documentElement;
            docEl.style.setProperty('--glow-rgb', theme.rgb);
            docEl.style.setProperty('--glow-light-rgb', theme.light_rgb);
            if(weightChart) renderWeightChart();
        }
        function generateThemeSwatches() {
            if (!ui.themeGrid) return;
            ui.themeGrid.innerHTML = '';
            CONFIG.THEMES.forEach(theme => {
                const s = document.createElement('button');
                s.className = "h-12 w-full rounded-md transition-all duration-200 hover:scale-110 focus:ring-2 ring-offset-2";
                s.style.cssText = `background-color:rgb(${theme.rgb});box-shadow:0 0 15px rgba(${theme.rgb},.5);ring-color:rgb(${theme.rgb});ring-offset-color:var(--bg-color)`;
                s.title = `åˆ‡æ¢åˆ° ${theme.name} ä¸»é¢˜`;
                s.onclick = () => changeTheme(theme);
                ui.themeGrid.appendChild(s);
            });
        }
        function toggleFullscreen() {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen().catch(err => console.error(err));
            else document.exitFullscreen();
        }
        async function displayPerformanceMetrics() {
            let html = `<h3>Page Load Times:</h3><p><strong>DOM Content Loaded:</strong> ${performance.getEntriesByType("navigation")[0].domContentLoadedEventEnd.toFixed(0)} ms</p>`;
            html += `<h3 class="mt-4">Hardware & Connection:</h3><p><strong>Logical CPU Cores:</strong> ${navigator.hardwareConcurrency||'N/A'}</p>`;
            if (navigator.deviceMemory) html += `<p><strong>Device Memory (est.):</strong> ${navigator.deviceMemory} GB</p>`;
            html += `<h3 class="mt-4">Browser & System:</h3><p><strong>User Agent:</strong> ${navigator.userAgent}</p>`;
            ui.performanceDataOutput.innerHTML = html;
        }
        async function loadAndProcessData() {
            ui.allRecordsContainer.innerHTML = `<p class="text-center">Loading Archive...</p>`;
            try {
                // IMPORTANT: This fetch call for a local file will likely fail due to browser security (CORS) 
                // if you open the HTML file directly. It works best when served via a local web server 
                // (e.g., using VS Code's "Live Server" extension).
                const res = await fetch(CONFIG.PET_RECORDS_PATH);
                if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
                const records = await res.json();
                allRecordsData = records.map(r => ({...r, processedDate: new Date((Math.floor(r.date || 0) * 1000) + 978307200000)})).sort((a,b) => b.processedDate - a.processedDate);
                weightChartData = allRecordsData.filter(r => r.activity === 'ä½“é‡æµ‹é‡' && typeof r.weight === 'number' && r.weight > 0).map(r=>({date:r.processedDate, weight:r.weight})).sort((a,b) => a.date - b.date);
                renderAllRecords();
                renderWeightChart();
            } catch (error) {
                console.error("Data load error:", error);
                ui.allRecordsContainer.innerHTML = `<p class="text-red-400 text-center p-4"><b>Error: Archive failed to load.</b><br>Please ensure the file at '${CONFIG.PET_RECORDS_PATH}' is correct and the page is served via a web server (not opened as a local file).</p>`;
            }
        }
        function renderAllRecords() {
            ui.allRecordsContainer.innerHTML = allRecordsData.map(r => `<div class="p-3 rounded-sm border-l-2" style="border-color:rgba(var(--glow-rgb),.5); background:rgba(var(--glow-rgb),.05)"><div class="flex justify-between items-center"><strong class="glow-text text-sm">${r.activity}</strong><time class="text-xs text-[color:var(--text-muted-color)]">${r.processedDate.toLocaleDateString()}</time></div><p class="mt-1">${r.notes||'No notes.'}</p></div>`).join('') || "<p>No records found.</p>";
        }
        function renderWeightChart() {
            if (!ui.weightChartCanvas) return;
            if (weightChart) weightChart.destroy();
            if (!weightChartData.length) { ui.weightChartCanvas.style.display = 'none'; return; }
            ui.weightChartCanvas.style.display = 'block';
            const s = getComputedStyle(document.documentElement);
            const pC = `rgb(${s.getPropertyValue('--glow-rgb').trim()})`, tC = s.getPropertyValue('--text-muted-color').trim(), gC = `rgba(${s.getPropertyValue('--glow-rgb').trim()},0.1)`;
            weightChart = new Chart(ui.weightChartCanvas.getContext('2d'), { type: 'line', data: { labels: weightChartData.map(d=>d.date.toLocaleDateString()), datasets: [{ label:'Weight(g)', data:weightChartData.map(d=>d.weight), borderColor:pC, tension:0.4, fill:true, backgroundColor:`rgba(${s.getPropertyValue('--glow-rgb').trim()},0.2)` }] }, options: { responsive:true, maintainAspectRatio:false, plugins:{legend:{display:false}}, scales:{y:{grid:{color:gC, drawBorder:false},ticks:{color:tC}},x:{grid:{display:false},ticks:{color:tC}}} }});
        }
        function animateRabbitLoop(t) { if(lastFrameTime===0) lastFrameTime=t; const d=t-lastFrameTime; lastFrameTime=t; animateRabbit(d); requestAnimationFrame(animateRabbitLoop); }
        function animateRabbit(delta) { if(!wanderingRabbit) return; const speed=100*(delta/1000); const transform=new DOMMatrix(getComputedStyle(wanderingRabbit).transform); let cx=transform.m41,cy=transform.m42; if(targetX===undefined||Math.hypot(targetX-cx,targetY-cy)<speed){targetX=Math.random()*(window.innerWidth-72);targetY=Math.random()*(window.innerHeight-72);} const dx=targetX-cx,dy=targetY-cy,dist=Math.hypot(dx,dy); if(dist>0){cx+=(dx/dist)*speed;cy+=(dy/dist)*speed;} wanderingRabbit.style.transform=`translate(${cx}px, ${cy}px)`; if(performance.now()-lastDropTime>DROP_INTERVAL_MS){const d=droppingsPool[currentDroppingIndex]; if(d){d.style.left=`${cx+33}px`;d.style.top=`${cy+46}px`;d.classList.remove('fade-out');void d.offsetWidth;d.classList.add('fade-out');currentDroppingIndex=(currentDroppingIndex+1)%MAX_DROPPINGS;lastDropTime=performance.now();}} }
        window.addEventListener('resize', () => { if(!wanderingRabbit) return; const t=new DOMMatrix(getComputedStyle(wanderingRabbit).transform); wanderingRabbit.style.transform=`translate(${Math.min(t.m41,window.innerWidth-72)}px, ${Math.min(t.m42,window.innerHeight-72)}px)`; targetX=Math.random()*(window.innerWidth-72); targetY=Math.random()*(window.innerHeight-72); });

        function populateChangelog() {
            if (!ui.changelogList) return;
            ui.changelogList.innerHTML = `
                <h4>âœ¨ v7.0.7 - ğŸ“œ The Bard's Rabbit (åŸæ¸¸è¯—å…”)</h4>
                <div class="changelog-entry">
                    <p><strong>A New Decree! (æ–°è°•ï¼Œæ˜­å‘Šå¤©ä¸‹ï¼):</strong></p>
                    <ul>
                        <li>Behold, a new Appellation! The archive is henceforth christened "The Bard's Rabbit", in honour of this grandiloquent transformation. (æ–°å·ï¼Œèµ«ç„¶åœ¨ç›®ï¼æ­¤å·å®—ä»Šå·²åŠ å†•ï¼Œå·æ›°â€œåŸæ¸¸è¯—å…”â€ï¼Œä»¥å½°å…¶æ–‡é‡‡ç„•ç„¶ä¹‹å˜ã€‚)</li>
                    </ul>
                    <p><strong>Sublime Refinements! (åŒ å¿ƒï¼Œç²¾ç›Šæ±‚ç²¾ï¼):</strong></p>
                    <ul>
                        <li>The very tongue of the chronicles hath been transmuted! Every entry, past and present, now speaks in the noble cadence of the Bard, its prose as rich as a midsummer's dream. (å²å†Œä¹‹è¨€è¾ï¼Œä»Šå·²åŒ–å¢ƒï¼è¿‡å¾€ä»Šæ¥ï¼Œå­—å­—ç ç‘ï¼Œçš†ä»¥éªšäººä¹‹é›…éŸµåŸå’ï¼Œå…¶æ–‡é‡‡æ–ç„¶ï¼Œå¦‚ä»²å¤å¤œä¹‹æ¢¦ã€‚)</li>
                        <li>The head-scripts of our sacred chambers, once writ in the common tongue of the East, now stand proclaimed in English, for clarity across all realms. (æ®¿å ‚ä¹‹æ ‡ï¼Œä»Šæ˜“è¥¿æ–‡ã€‚æ˜”æ—¥ä¸œæ–¹ä¹‹è¯­ï¼Œä»Šæ¢è‹±æ ¼åˆ©ä¹‹è¨€ï¼Œä»¥æ±‚å››æµ·ä¹‹å†…ï¼Œè§‚è€…çš†æ˜ã€‚)</li>
                        <li>An Aura of Science! The user interface hath been imbued with a new, technological spirit, featuring geometric corners and pulsating glows, that it may feel as a console from a future yet to dawn. (ç§‘æŠ€ä¹‹æ¯ï¼Œä»Šå·²è´¯æ³¨ï¼æ­¤ç•Œé¢å·²æ³¨å…¥å´­æ–°ä¹‹ç§‘æŠ€é­‚é­„ï¼Œæ£±è§’åˆ†æ˜ï¼Œè¾‰å…‰è„‰åŠ¨ï¼Œæå¦‚æ¥è‡ªæœªè‡³ä¹‹æ™¨æ›¦ä¸­çš„ä¸€å°ç¥æœºã€‚)</li>
                    </ul>
                    <p><strong>Maladies Mended! (æ—§ç–¾ï¼Œä»Šå·²ç—Šæ„ˆï¼):</strong></p>
                    <ul>
                         <li>The Mute Buttons and Silent Data! The grievous malady that rendered all buttons lifeless and the data-stream a barren desert hath been vanquished. Interactivity is restored, and the archives once more sing with information. (å–‘å“‘ä¹‹é’®ï¼Œæ²‰å¯‚ä¹‹æ•°ï¼æ˜”æ—¥æŒ‰é’®æ­»å¯‚ï¼Œæ•°æ®è’èŠœä¹‹ç–¾ï¼Œä»Šå·²å°½é™¤ã€‚äº¤äº’é‡ç”Ÿï¼Œå·å®—é‡ç„•æ–°ç”Ÿã€‚)</li>
                    </ul>
                </div>

                <h4>âœ¨ v7.0.6 - ğŸ“œ The Bard's Rabbit (åŸæ¸¸è¯—å…”)</h4>
                <div class="changelog-entry">
                    <p><strong>A New Decree! (æ–°è°•ï¼Œæ˜­å‘Šå¤©ä¸‹ï¼):</strong></p>
                    <ul>
                        <li>Behold, a new Appellation! The archive is henceforth christened "The Bard's Rabbit", in honour of this grandiloquent transformation. (æ–°å·ï¼Œèµ«ç„¶åœ¨ç›®ï¼æ­¤å·å®—ä»Šå·²åŠ å†•ï¼Œå·æ›°â€œåŸæ¸¸è¯—å…”â€ï¼Œä»¥å½°å…¶æ–‡é‡‡ç„•ç„¶ä¹‹å˜ã€‚)</li>
                    </ul>
                    <p><strong>Sublime Refinements! (åŒ å¿ƒï¼Œç²¾ç›Šæ±‚ç²¾ï¼):</strong></p>
                    <ul>
                        <li>The very tongue of the chronicles hath been transmuted! Every entry, past and present, now speaks in the noble cadence of the Bard, its prose as rich as a midsummer's dream. (å²å†Œä¹‹è¨€è¾ï¼Œä»Šå·²åŒ–å¢ƒï¼è¿‡å¾€ä»Šæ¥ï¼Œå­—å­—ç ç‘ï¼Œçš†ä»¥éªšäººä¹‹é›…éŸµåŸå’ï¼Œå…¶æ–‡é‡‡æ–ç„¶ï¼Œå¦‚ä»²å¤å¤œä¹‹æ¢¦ã€‚)</li>
                        <li>The head-scripts of our sacred chambers, once writ in the common tongue of the East, now stand proclaimed in English, for clarity across all realms. (æ®¿å ‚ä¹‹æ ‡ï¼Œä»Šæ˜“è¥¿æ–‡ã€‚æ˜”æ—¥ä¸œæ–¹ä¹‹è¯­ï¼Œä»Šæ¢è‹±æ ¼åˆ©ä¹‹è¨€ï¼Œä»¥æ±‚å››æµ·ä¹‹å†…ï¼Œè§‚è€…çš†æ˜ã€‚)</li>
                    </ul>
                    <p><strong>Maladies Mended! (æ—§ç–¾ï¼Œä»Šå·²ç—Šæ„ˆï¼):</strong></p>
                    <ul>
                         <li>The celestial map to our treasured data-hoard hath been corrected. The fetcher's gaze, no longer astray, now finds its trove at 'dist/bunnycc/PetRecords.json' with unerring grace. (å®åº“ä¹‹å¤©å›¾ï¼Œä»Šå·²å½’æ­£ã€‚å¯»è¸ªè€…ä¹‹ç›®å…‰ï¼Œä¸å†è¿·ç¦»ï¼Œç²¾å‡†æ— è¯¯ï¼Œç›´æŠµ 'dist/bunnycc/PetRecords.json' ä¹‹æ‰€åœ¨ã€‚)</li>
                    </ul>
                </div>
                
                <h4>âœ¨ v7.0.5 - ğŸŒŒ ProMotion Rabbit (ProMotionä¹‹å…”)</h4>
                <div class="changelog-entry">
                    <p><strong>A New Decree! (æ–°è°•ï¼Œæ˜­å‘Šå¤©ä¸‹ï¼):</strong></p>
                    <ul>
                        <li>The Oracle's Gaze Deepened! Our performance monitor now doth reveal further secrets of the machine's heart and its tether to the world, showing forth the number of its thinking cores, its memory's vastness, the screen's own measure, and the nature of its worldly connection. (å…ˆçŸ¥ä¹‹çœ¼ï¼Œæ´æ‚‰æ›´æ·±ï¼ä»Šæ€§èƒ½ç›‘å¯Ÿä¹‹æ³•ï¼Œå¯çª¥æœºå…³ä¹‹å¿ƒã€å°˜ä¸–ä¹‹ç½‘ï¼Œå°½æ˜¾å…¶æ€ç»ªä¹‹æ ¸ã€è®°å¿†ä¹‹æ¸Šã€æ˜é•œä¹‹å°ºã€åŠç½‘ç»œä¹‹å½¢ã€‚)</li>
                    </ul>
                    <p><strong>Sublime Refinements! (åŒ å¿ƒï¼Œç²¾ç›Šæ±‚ç²¾ï¼):</strong></p>
                    <ul>
                        <li>A Dance Unchained by Time! The animations, once bound to sixty turns of the glass per second, are now set free. On screens of ProMotion's grace, they shall dance at a pace twice as swift, yet lose naught of their measured tread on common glass. (å…‰é˜´ä¹‹èˆï¼ŒæŒ£è„±æ·é”ï¼åŠ¨ç”»ä¹‹å¾‹ï¼Œæ˜”ä¸ºç§’é—´å…­åä¹‹é™ï¼Œä»Šå·²å…¨ç„¶è§£æ”¾ã€‚äºProMotionä¹‹å±ï¼Œå…¶èˆé€Ÿå€å¢ï¼Œç„¶äºå‡¡å±ä¹‹ä¸Šï¼Œæ­¥å±¥ä¾ç„¶ä»å®¹ã€‚)</li>
                        <li>Whispers for the Inquisitive! Upon every sigil and button that doth invite a click, a title now whispers its purpose, a boon to the curious soul. (æ™ºè€…ä¹‹è¯­ï¼Œç‚¹çŸ³æˆé‡‘ï¼å‡¡å¯ç‚¹ä¹‹ç¬¦å°ï¼Œçš†é™„å…¶åï¼Œä»¥å‘Šå…¶ç”¨ï¼Œä¾¿è§ˆè€…ä¹‹å¿ƒã€‚)</li>
                        <li>A Scribe's International Hand! The archive's title and its keeper's name, once writ in the script of the Orient, now stand in the Roman tongue, a first step toward all nations. (ä¹¦è€…ä¹‹ç¬”ï¼Œæ”¾çœ¼å››æµ·ï¼æ¡ˆå·ä¹‹åï¼Œå¸æŒè€…ä¹‹å·ï¼Œæ˜”ä¸ºä¸œæ–¹ä¹‹æ–‡ï¼Œä»Šæ”¹ç½—é©¬ä¹‹å­—ï¼Œæ­¤ä¹ƒé€šè¾¾ä¸‡å›½ä¹‹å§‹ã€‚)</li>
                    </ul>
                    <p><strong>Maladies Mended! (æ—§ç–¾ï¼Œä»Šå·²ç—Šæ„ˆï¼):</strong></p>
                    <ul>
                        <li>The Phantom of the Dropping, Banished! A vexing error, `DROP_INTERVAL_MS is not defined`, which did plague the console with ceaseless cries, hath been smote and cast into the void. The rabbit's trail is once more whole. (é­…å½±æ— è¸ªï¼Œæ—§ç–¾ç—Šæ„ˆï¼`DROP_INTERVAL_MS` ä¹‹è°¬ï¼Œæ˜”æ—¥äºç¥æœºå°å“€åšä¸ç»ï¼Œä»Šå·²ä¸€å‡»è€Œæ•£ï¼Œç°é£çƒŸç­ã€‚ç‰å…”ä¹‹è¸ªï¼Œå¤å½’äº•ç„¶ã€‚)</li>
                    </ul>
                </div>
            `;
        }
    </script>
</body>
</html>
